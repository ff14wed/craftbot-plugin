{"version":3,"sources":["api/gql.ts","api/gqlClient.ts","store/entity.ts","store/craft.ts","store/stream.ts","components/PaddedCard.jsx","components/ResourceValue.tsx","components/TwoColumnTable.tsx","components/Details.tsx","components/InlineDiv.jsx","components/CraftListItem.tsx","components/CraftList.tsx","components/CraftHistory.tsx","components/App.tsx","index.tsx"],"names":["gql","_temp","Object","classCallCheck","this","classJobFragment","_templateObject","resourcesFragment","_templateObject2","actionFragment","_templateObject3","statusFragment","_templateObject4","entityFragment","_templateObject5","craftingInfoFragment","_templateObject6","streamFragment","_templateObject7","streamSubscription","_templateObject8","entitySubscription","_templateObject9","streamQuery","_templateObject10","listStreamsQuery","_templateObject11","hookMutation","_templateObject12","errHandlerLink","onError","_ref","graphQLErrors","networkError","map","_ref2","message","locations","path","console","log","concat","executeOperation","httpLink","operation","Promise","resolve","reject","makePromise","execute","then","result","data","errors","catch","error","GQLClient","apiURL","apiToken","_this","wsLink","listStreams","asyncToGenerator","regenerator_default","a","mark","_callee","wrap","_context","prev","next","query","sent","abrupt","streams","stop","getStream","_ref4","_callee2","streamID","variables","_context2","stream","_x","apply","arguments","subscribeToStreamEvents","handleStreamEvent","subscribe","subscriptionData","streamEvent","_streamEvent$type","type","__typename","eventData","objectWithoutProperties","subscribeToEntityEvents","handleEntityEvent","entityEvent","entityID","_entityEvent$type","httpOpts","headers","Authorization","wsConnectionParams","authorization","undefined","ApolloLink","from","HttpLink","objectSpread","uri","WebSocketLink","replace","options","reconnect","connectionParams","Entity","ent","id","index","name","initializerDefineProperty","_descriptor","_descriptor2","_descriptor3","_descriptor4","_descriptor5","level","lastAction","assign","classJob","resources","statuses","forEach","s","idx","typename","action","status","mp","maxMP","l","entries","slicedToArray","sName","extra","push","JSON","stringify","observable","computed","deltaString","delta","toConditionName","condition","dayjs","extend","LocalizedFormat","Craft","initialCraftInfo","date","recipe","craft_descriptor","craft_descriptor2","craft_descriptor3","craft_descriptor4","craft_descriptor5","_descriptor6","_descriptor7","_descriptor8","_descriptor9","_descriptor10","_descriptor11","_descriptor12","_descriptor13","_descriptor14","_descriptor15","_descriptor16","stepNum","Date","now","craftingInfo","lastCraftActionID","completed","durability","durabilityDelta","progress","progressDelta","quality","qualityDelta","hqChance","previousCondition","currentCondition","lastCraftActionName","reuseProc","hist","info","history","failed","format","length","Completed","Failed","RecipeID","RecipeName","RecipeLevel","recipeLevel","StepNum","Durability","Progress","difficulty","Quality","HQChance","PreviousCondition","CurrentCondition","LastCraftAction","ReuseProc","streamStoreDefaultProps","streamStore","store_stream","gqlClient","pluginParams","getActiveStreamID","entities","characterID","_iterator","Symbol","iterator","_iteratorNormalCompletion","_step","done","value","set","loading","currentCraft","craftingEvent","newCraft","craftHistory","currentCraftID","_this2","characterEntity","setEntities","removeEntity","addEntity","entity","delete","_this3","clear","selectedCraftID","get","has","Map","styled","Card","PaddedCard_templateObject","Colors","DARK_GRAY2","ResourceRow","div","ResourceValue_templateObject","ResourceText","ResourceValue_templateObject2","ResourceBar","ResourceValue_templateObject3","ResourceValue","_this$props","props","current","max","color","ratioPct","isNaN","react_default","createElement","style","className","Classes","PROGRESS_BAR","PROGRESS_NO_ANIMATION","PROGRESS_METER","backgroundColor","width","Component","GridBox","TwoColumnTable_templateObject","NameCell","TEXT_MUTED","TEXT_SMALL","children","TwoColumnTable","infos","key","t","React","isValidElement","TwoColumnTable_NameCell","NonIdealBox","Details_templateObject","Details","inject","observer","_this$props$streamSto","noCraftMessage","nonIdealState","icon","title","description","PaddedCard","elevation","Elevation","THREE","cp","maxCP","lastActionName","displayStatusList","Level","CP","ResourceValue_ResourceValue","GOLD3","LastAction","Statuses","CurrentCraft","TwoColumnTable_TwoColumnTable","defaultProps","InlineDiv_templateObject","smallClasses","CraftListItem","onClick","onSelect","craft","selected","child","InlineDiv","numSteps","timestamp","menuItem","text","active","List","UL","CraftList_templateObject","GRAY1","DARK_GRAY5","CraftListContainer","html","CraftList_CraftList","CraftList","setSelectedCraftID","selectedCraft","Array","reverse","c","CraftListItem_CraftListItem","CraftHistory_templateObject","Container","CraftHistory_templateObject2","Content","CraftHistory_templateObject3","CraftHistory","htmlTable","condensed","interactive","striped","CraftHistory_NonIdealBox","AppRoot","App_templateObject","DARK_GRAY3","App","react","Details_Details","CraftList_CraftListContainer","CraftHistory_CraftHistory","getPluginParams","window","waitForInit","initPlugin","params","Main","initialize","App_App","ReactDOM","render","mobx_react_module","src_Main","document","getElementById"],"mappings":"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","file":"static/js/main.035afbce.chunk.js","sourcesContent":["import gql from 'graphql-tag';\n\nexport default new class {\n  classJobFragment = gql`\n    fragment classJob on ClassJob {\n      id\n      name\n      abbreviation\n    }\n  `;\n\n  resourcesFragment = gql`\n    fragment resources on Resources {\n      mp\n      maxMP\n      lastTick\n    }\n  `;\n\n  actionFragment = gql`\n    fragment action on Action {\n      id\n      name\n      targetID\n      useTime\n    }\n  `;\n\n  statusFragment = gql`\n    fragment status on Status {\n      id\n      extra\n      name\n      description\n      startedTime\n      duration\n      actorID\n      lastTick\n    }\n  `;\n\n  entityFragment = gql`\n    fragment entity on Entity {\n      id\n      index\n      name\n      level\n      classJob {\n        ...classJob\n      }\n      resources {\n        ...resources\n      }\n      lastAction {\n        ...action\n      }\n      statuses {\n        ...status\n      }\n    }\n    ${this.classJobFragment}\n    ${this.resourcesFragment}\n    ${this.actionFragment}\n    ${this.statusFragment}\n  `;\n\n  craftingInfoFragment = gql`\n    fragment craftingInfo on CraftingInfo {\n      recipe {\n        id\n        name\n        recipeLevel\n        element\n        canHQ\n        difficulty\n        quality\n        durability\n      }\n\n      lastCraftActionID\n      lastCraftActionName\n      stepNum\n\n      progress\n      progressDelta\n\n      quality\n      qualityDelta\n\n      hqChance\n\n      durability\n      durabilityDelta\n\n      currentCondition\n      previousCondition\n\n      reuseProc\n    }\n  `;\n\n  streamFragment = gql`\n    fragment stream on Stream {\n      id\n      characterID\n      craftingInfo {\n        ...craftingInfo\n      }\n\n      entities {\n        ...entity\n      }\n    }\n    ${this.entityFragment}\n    ${this.craftingInfoFragment}\n  `;\n\n  streamSubscription = gql`\n    subscription Streams {\n      streamEvent {\n        streamID\n        type {\n          __typename\n          ... on UpdateCraftingInfo {\n            craftingInfo {\n              ...craftingInfo\n            }\n          }\n        }\n      }\n    }\n    ${this.craftingInfoFragment}\n  `;\n\n  entitySubscription = gql`\n    subscription Entities {\n      entityEvent {\n        streamID\n        entityID\n        type {\n          __typename\n          ... on AddEntity {\n            entity {\n              ...entity\n            }\n          }\n          ... on RemoveEntity {\n            id\n          }\n          ... on SetEntities {\n            entities {\n              ...entity\n            }\n          }\n          ... on UpdateClass {\n            classJob {\n              ...classJob\n            }\n          }\n          ... on UpdateLastAction {\n            action {\n              ...action\n            }\n          }\n          ... on UpsertStatus {\n            index\n            status {\n              ...status\n            }\n          }\n          ... on RemoveStatus {\n            index\n          }\n          ... on UpdateResources {\n            resources {\n              ...resources\n            }\n          }\n        }\n      }\n    }\n    ${this.entityFragment}\n    ${this.classJobFragment}\n    ${this.actionFragment}\n    ${this.statusFragment}\n    ${this.resourcesFragment}\n  `;\n\n  streamQuery = gql`\n    query GetStream($streamID: Int!) {\n      stream(streamID: $streamID) {\n        ...stream\n      }\n    }\n    ${this.streamFragment}\n  `;\n\n  listStreamsQuery = gql`\n    query AllStreams {\n      streams {\n        id\n      }\n    }\n  `;\n\n  hookMutation = gql`\n    mutation SendHookData($req: StreamRequest!) {\n      sendStreamRequest(request: $req)\n    }\n  `;\n}()","import gql from './gql';\n\nimport { ApolloLink, execute, makePromise, GraphQLRequest } from 'apollo-link';\nimport { HttpLink } from 'apollo-link-http';\nimport { WebSocketLink } from 'apollo-link-ws';\nimport { onError } from \"apollo-link-error\";\n\nconst errHandlerLink = onError(({ graphQLErrors, networkError }) => {\n  if (graphQLErrors)\n    graphQLErrors.map(({ message, locations, path }) =>\n      console.log(\n        `[GraphQL error]: Message: ${message}, Location: ${locations}, Path: ${path}`\n      )\n    );\n  if (networkError) console.log(`[Network error]: ${networkError}`);\n});\n\nconst executeOperation = (httpLink: ApolloLink, operation: GraphQLRequest) => {\n  // Funnel errors into a single promise rejection\n  return new Promise<{ [key: string]: any }>((resolve, reject) => {\n    makePromise(execute(httpLink, operation))\n      .then((result) => {\n        if (result.data) {\n          resolve(result.data);\n        } else {\n          reject(result.errors);\n        }\n      })\n      .catch((error) => reject(error));\n  })\n};\n\nexport default class GQLClient {\n  private httpLink: ApolloLink;\n  private wsLink: ApolloLink;\n\n  constructor(apiURL: string, apiToken?: string) {\n    let httpOpts = (apiToken) ? {\n      headers: {\n        Authorization: apiToken,\n      }\n    } : {};\n    let wsConnectionParams = (apiToken) ? () => ({\n      authorization: apiToken,\n    }) : undefined;\n\n    this.httpLink = ApolloLink.from([\n      errHandlerLink,\n      new HttpLink({ uri: apiURL, ...httpOpts }),\n    ]);\n    this.wsLink = ApolloLink.from([\n      errHandlerLink,\n      new WebSocketLink({\n        uri: apiURL.replace('http://', 'ws://'),\n        options: {\n          reconnect: true,\n          connectionParams: wsConnectionParams,\n        },\n      }),\n    ]);\n  }\n\n  public listStreams = async () => {\n    const data = await executeOperation(\n      this.httpLink, { query: gql.listStreamsQuery },\n    )\n    return data.streams;\n  }\n\n  public getStream = async (streamID: number) => {\n    const variables = { streamID }\n    const data = await executeOperation(\n      this.httpLink, { query: gql.streamQuery, variables },\n    )\n    return data.stream;\n  }\n\n  public subscribeToStreamEvents = (\n    streamID: number, handleStreamEvent: (type: string, data: any) => void\n  ) =>\n    execute(this.wsLink, { query: gql.streamSubscription })\n      .subscribe({\n        next: (subscriptionData) => {\n          if (!subscriptionData.data) { return; }\n          let streamEvent = subscriptionData.data.streamEvent;\n          if (streamEvent.streamID !== streamID) { return; }\n          let { __typename, ...eventData } = streamEvent.type;\n          handleStreamEvent(__typename, eventData);\n        },\n      });\n\n  public subscribeToEntityEvents = (\n    streamID: number, handleEntityEvent: (entityID: number, type: string, data: any) => void,\n  ) =>\n    execute(this.wsLink, { query: gql.entitySubscription })\n      .subscribe({\n        next: (subscriptionData) => {\n          if (!subscriptionData.data) { return; }\n          let entityEvent = subscriptionData.data.entityEvent;\n          if (entityEvent.streamID !== streamID) { return; }\n\n          let { entityID } = entityEvent;\n          let { __typename, ...eventData } = entityEvent.type;\n          handleEntityEvent(entityID, __typename, eventData);\n        },\n      });\n}\n","import { observable, action, computed } from 'mobx';\n\nexport interface ClassJob {\n  id: number;\n  name: string;\n  abbreviation: string;\n}\n\nexport interface Resources {\n  mp: number;\n  maxMP: number;\n  lastTick: number;\n}\n\nexport interface Status {\n  id: number;\n  extra: number;\n  name: string;\n  description: string;\n  startedTime: number;\n  duration: number;\n  actorID: number;\n  lastTick: number;\n}\n\nexport interface Action {\n  id: number;\n  name: string;\n  targetID: number;\n  useTime: number;\n}\n\nexport interface EntitySpec {\n  id: number;\n  index: number;\n  name: string;\n  level: number;\n  classJob: ClassJob;\n  resources: Resources;\n  lastAction?: Action;\n  statuses: Status[];\n}\n\nexport default class Entity {\n  id = 0;\n  index = -1;\n  name = \"\";\n\n  @observable level = -1;\n  @observable classJob: ClassJob;\n  @observable resources: Resources;\n  @observable lastAction?: Action;\n  @observable statuses: { [idx: number]: Status } = {};\n\n  constructor(ent: EntitySpec) {\n    let {\n      id, index, name, level, lastAction,\n    } = ent;\n    Object.assign(this, { id, index, name, level, lastAction });\n\n    this.classJob = ent.classJob;\n    this.resources = ent.resources;\n    ent.statuses.forEach((s, idx) => {\n      if (s) { this.statuses[idx] = s; }\n    });\n  }\n\n  @action handleEntityEvent(typename: string, eventData: any) {\n    switch (typename) {\n      case \"UpdateClass\":\n        this.classJob = eventData.classJob;\n        break;\n      case \"UpdateLastAction\":\n        this.lastAction = eventData.action;\n        break;\n      case \"UpsertStatus\":\n        this.statuses[eventData.index] = eventData.status;\n        break;\n      case \"RemoveStatus\":\n        delete this.statuses[eventData.index];\n        break;\n      case \"UpdateResources\":\n        this.resources = eventData.resources;\n        break;\n    }\n  }\n\n  @computed get lastActionName() {\n    if (this.lastAction) {\n      return this.lastAction.name;\n    }\n    return \"\";\n  }\n\n  // CP is the same thing as MP\n  @computed get cp() {\n    return this.resources.mp;\n  }\n\n  @computed get maxCP() {\n    return this.resources.maxMP;\n  }\n\n  @computed get displayStatusList() {\n    let l: string[] = [];\n    Object.entries(this.statuses).forEach(([idx, s]) => {\n      let sName = `${s.id}`;\n      if (s.extra) {\n        sName = `${sName} (${s.extra})`;\n      }\n      l.push(sName);\n    });\n    return JSON.stringify(l);\n  }\n}\n","import { observable, action, computed } from 'mobx';\n\nimport dayjs from 'dayjs';\nimport LocalizedFormat from 'dayjs/plugin/localizedFormat'\ndayjs.extend(LocalizedFormat)\n\nfunction deltaString(delta: number) {\n  if (delta >= 0) {\n    return `(+${delta})`;\n  }\n  return `(${delta})`;\n}\n\nexport type ConditionName = \"Normal\" | \"Good\" | \"Excellent\" | \"Poor\";\n\nfunction toConditionName(condition: number): ConditionName {\n  switch (condition) {\n    case 1:\n      return \"Normal\";\n    case 2:\n      return \"Good\";\n    case 3:\n      return \"Excellent\";\n  }\n  return \"Poor\";\n}\n\nexport interface Recipe {\n  id: number;\n  name: string;\n  recipeLevel: number;\n  element: number;\n  canHQ: boolean;\n  difficulty: number;\n  quality: number;\n  durability: number;\n}\n\nexport interface CraftInfo {\n  recipe: Recipe;\n\n  lastCraftActionID: number;\n  lastCraftActionName: string;\n  stepNum: number;\n\n  progress: number;\n  progressDelta: number;\n\n  quality: number;\n  qualityDelta: number;\n\n  hqChance: number;\n\n  durability: number;\n  durabilityDelta: number;\n\n  currentCondition: number;\n  previousCondition: number;\n\n  reuseProc: boolean;\n}\n\nexport interface DisplayCraftInfo {\n  id: string;\n  Completed: string;\n  Failed: string;\n\n  RecipeID: number;\n  RecipeName: string;\n  RecipeLevel: number;\n  StepNum: number;\n  Durability: string;\n  Progress: string;\n  Quality: string;\n  HQChance: string;\n  PreviousCondition: ConditionName;\n  CurrentCondition: ConditionName;\n  LastCraftAction: string;\n  ReuseProc: string;\n}\n\n\nexport default class Craft {\n  date = 0;\n  recipe: Recipe;\n\n  @observable history: DisplayCraftInfo[] = [];\n  @observable stepNum = 0;\n\n  @observable durability = 0;\n  @observable durabilityDelta = 0;\n\n  @observable progress = 0;\n  @observable progressDelta = 0;\n\n  @observable quality = 0;\n  @observable qualityDelta = 0;\n  @observable hqChance = 1;\n\n  @observable previousCondition = 1;\n  @observable currentCondition = 1;\n\n  @observable lastCraftActionID = 0;\n  @observable lastCraftActionName = \"\";\n\n  @observable completed = false;\n  @observable failed = false;\n\n  @observable reuseProc = false;\n\n  constructor(initialCraftInfo: CraftInfo) {\n    let { recipe, stepNum } = initialCraftInfo;\n    this.recipe = recipe;\n    this.stepNum = stepNum;\n\n    this.date = Date.now();\n  }\n\n  @action craftingEvent(craftingInfo: CraftInfo) {\n    if (craftingInfo.stepNum === 0) {\n      this.failed = true;\n      return;\n    }\n    if (craftingInfo.lastCraftActionID <= 0) {\n      return;\n    }\n\n    if (craftingInfo.stepNum === this.stepNum) {\n      this.completed = true;\n    } else {\n      this.stepNum = craftingInfo.stepNum;\n    }\n\n    this.durability = craftingInfo.durability;\n    this.durabilityDelta = craftingInfo.durabilityDelta;\n\n    this.progress = craftingInfo.progress;\n    this.progressDelta = craftingInfo.progressDelta;\n\n    this.quality = craftingInfo.quality;\n    this.qualityDelta = craftingInfo.qualityDelta;\n\n    this.hqChance = craftingInfo.hqChance;\n\n    this.previousCondition = craftingInfo.previousCondition;\n    this.currentCondition = craftingInfo.currentCondition;\n\n    this.lastCraftActionID = craftingInfo.lastCraftActionID;\n    this.lastCraftActionName = craftingInfo.lastCraftActionName;\n\n    this.reuseProc = craftingInfo.reuseProc;\n\n    let hist = Object.assign({}, this.info);\n    hist.id = `${Date.now()}`;\n    this.history.push(hist);\n  }\n\n  @computed get id() {\n    return dayjs(this.date).format();\n  }\n\n  @computed get timestamp() {\n    return dayjs(this.date).format('l h:mm:ss a');\n  }\n\n  @computed get numSteps() {\n    return this.history.length;\n  }\n\n  @computed get condition() {\n    return toConditionName(this.currentCondition);\n  }\n\n  @computed get info(): DisplayCraftInfo {\n    return {\n      id: this.id,\n      Completed: `${this.completed}`,\n      Failed: `${this.failed}`,\n\n      RecipeID: this.recipe.id,\n      RecipeName: this.recipe.name,\n      RecipeLevel: this.recipe.recipeLevel,\n      StepNum: this.stepNum,\n      Durability: `${this.durability} / ${this.recipe.durability} ${deltaString(this.durabilityDelta)}`,\n      Progress: `${this.progress} / ${this.recipe.difficulty} ${deltaString(this.progressDelta)}`,\n      Quality: `${this.quality} / ${this.recipe.quality} ${deltaString(this.qualityDelta)}`,\n      HQChance: `${this.hqChance}%`,\n      PreviousCondition: toConditionName(this.previousCondition),\n      CurrentCondition: toConditionName(this.currentCondition),\n      LastCraftAction: `${this.lastCraftActionName} (${this.lastCraftActionID})`,\n      ReuseProc: `${this.reuseProc}`,\n    }\n  }\n}\n","import { action, observable, computed } from 'mobx';\nimport GQLClient from '../api/gqlClient';\n\nimport Entity, { EntitySpec } from './entity';\nimport Craft from './craft';\n\nexport interface StreamStoreProps {\n  streamStore: Stream;\n}\nexport const streamStoreDefaultProps = { streamStore: (null as unknown) as Stream };\n\nexport interface PluginParams {\n  apiURL: string;\n  apiToken?: string;\n  streamID?: number;\n}\n\nclass Stream {\n  @observable loading = true;\n\n  gqlClient?: GQLClient;\n  streamID = 0;\n  apiURL = '';;\n\n  @observable craftHistory = new Map<string, Craft>();\n  @observable selectedCraftID = \"\";\n  @observable currentCraftID = \"\";\n  @observable entities = new Map<number, Entity>();\n  @observable characterID = 0;\n\n  @action async initialize(pluginParams: PluginParams) {\n    this.gqlClient = new GQLClient(pluginParams.apiURL, pluginParams.apiToken);\n    const streamID = this.streamID = await this.getActiveStreamID(pluginParams);\n    this.subscribeToStreamEvents();\n    this.subscribeToEntityEvents();\n\n    if (!streamID) { return; }\n\n    const stream = await this.gqlClient.getStream(streamID);\n\n    const { entities, characterID } = stream;\n    this.characterID = characterID;\n    for (let ent of entities) {\n      this.entities.set(ent.id, new Entity(ent));\n    }\n\n    this.loading = false;\n  }\n\n  async getActiveStreamID(pluginParams: PluginParams) {\n    if (pluginParams.streamID) {\n      return pluginParams.streamID;\n    } else {\n      const streams = await this.gqlClient!.listStreams();\n      if (streams.length > 0) {\n        return streams[0].id;\n      }\n    }\n    return 0;\n  }\n\n  @action subscribeToStreamEvents() {\n    return this.gqlClient!.subscribeToStreamEvents(\n      this.streamID,\n      action((typename: string, eventData: any) => {\n        if (this.loading) { return; }\n        switch (typename) {\n          case \"UpdateIDs\":\n            this.characterID = eventData.characterID;\n            break;\n          case \"UpdateCraftingInfo\":\n            if (!eventData.craftingInfo) {\n              this.currentCraftID = \"\";\n            } else if (this.currentCraft) {\n              this.currentCraft.craftingEvent(eventData.craftingInfo);\n            } else {\n              let newCraft = new Craft(eventData.craftingInfo);\n              this.craftHistory.set(newCraft.id, newCraft);\n              this.currentCraftID = newCraft.id;\n            }\n            break;\n        }\n      }));\n  }\n\n  @action subscribeToEntityEvents() {\n    return this.gqlClient!.subscribeToEntityEvents(\n      this.streamID,\n      action((entityID: number, typename: string, eventData: any) => {\n        if (this.loading) { return; }\n\n        if (typename === \"AddEntity\") {\n          this.addEntity(eventData.entity);\n          return;\n        } else if (typename === \"RemoveEntity\") {\n          this.removeEntity(eventData.id);\n          return;\n        } else if (typename === \"SetEntities\") {\n          this.setEntities(eventData.entities);\n          return;\n        }\n        if (this.characterEntity && entityID === this.characterEntity.id) {\n          this.characterEntity.handleEntityEvent(typename, eventData);\n        }\n      }));\n  }\n\n  @action addEntity(ent: EntitySpec) {\n    this.entities.set(ent.id, new Entity(ent));\n  }\n\n  @action removeEntity(id: number) {\n    this.entities.delete(id);\n  }\n\n  @action setEntities(entities: EntitySpec[]) {\n    this.entities.clear();\n    entities.forEach((ent) => {\n      this.addEntity(ent);\n    });\n  }\n\n  @action setSelectedCraftID(id: string) {\n    this.selectedCraftID = id;\n  }\n\n  @computed get characterEntity() {\n    return this.entities.get(this.characterID);\n  }\n\n  @computed get selectedCraft() {\n    if (this.craftHistory.has(this.selectedCraftID)) {\n      return this.craftHistory.get(this.selectedCraftID);\n    } else {\n      return null;\n    }\n  }\n\n  @computed get currentCraft() {\n    return this.craftHistory.get(this.currentCraftID);\n  }\n}\n\nexport default new Stream();\n","import { Card, Colors } from '@blueprintjs/core';\nimport styled from 'styled-components';\n\nexport default styled(Card)`\n  padding: 20px;\n  margin: 20px;\n  && {\n    background-color: ${Colors.DARK_GRAY2};\n  }\n`;\n\n","import React, { Component } from 'react';\n\nimport styled from 'styled-components';\nimport { Classes } from '@blueprintjs/core';\n\nconst ResourceRow = styled.div`\n  display: flex;\n  flex-direction: row;\n`;\n\nconst ResourceText = styled.div`\n  flex: 1 0 auto;\n  margin-right: 5px;\n`;\n\nconst ResourceBar = styled.div`\n  margin: 5px 0px;\n  flex: 0 0 auto;\n  margin-left: 5px;\n  flex-basis: 120px;\n`;\n\ninterface ResourceValueProps {\n  current: number;\n  max: number;\n  color: string;\n}\n\nexport default class ResourceValue extends Component<ResourceValueProps> {\n  static propTypes = {\n  };\n\n  render() {\n    let { current, max, color } = this.props;\n    let ratioPct = (current / max) * 100;\n    if (isNaN(ratioPct)) {\n      ratioPct = 100;\n    }\n    return (\n      <ResourceRow>\n        <ResourceText style={{ color: color }}>{current}/{max}</ResourceText>\n        <ResourceBar>\n          <div className={`${Classes.PROGRESS_BAR} ${Classes.PROGRESS_NO_ANIMATION}`}>\n            <div className={Classes.PROGRESS_METER} style={{\n              backgroundColor: color,\n              width: `${ratioPct}%`,\n            }}></div>\n          </div>\n        </ResourceBar>\n      </ResourceRow>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport { Classes } from '@blueprintjs/core';\nimport styled from 'styled-components';\n\nimport dayjs from 'dayjs';\n\nimport LocalizedFormat from 'dayjs/plugin/localizedFormat'\ndayjs.extend(LocalizedFormat)\n\nconst GridBox = styled.div`\n  display: grid;\n  grid-row-gap: 5px;\n  grid-column-gap: 10px;\n  grid-template-columns: max-content auto;\n  grid-auto-rows: minmax(18px, auto);\n`;\n\nconst NameCell = (props: { children: any }) =>\n  <div className={`${Classes.TEXT_MUTED} ${Classes.TEXT_SMALL}`}>{props.children}</div>\n\n\ninterface TwoColumnTableProps {\n  infos: { [key: string]: any } | Array<{ [key: string]: any }>;\n}\n\nexport default class TwoColumnTable extends Component<TwoColumnTableProps> {\n  render() {\n    let entries: JSX.Element[] = [];\n    Object.entries(this.props.infos).forEach(([key, value]) => {\n      let t = typeof value;\n      if (t !== \"number\" && t !== \"string\" && !React.isValidElement(value)) {\n        if (!value) {\n          value = (<div></div>);\n        } else {\n          value = (<TwoColumnTable infos={value} />);\n        }\n      }\n      if (key === \"lastUpdated\" ||\n        key === \"lastTick\" ||\n        key === \"startedTime\" ||\n        key === \"useTime\") {\n        value = dayjs(value).format(\"L HH:mm:ss.SSS\");\n      }\n\n      entries.push(<NameCell key={`${key}-name`}>{key}</NameCell>);\n      entries.push(<div key={`${key}-info`}>{value}</div>);\n    });\n\n    return (\n      <GridBox>\n        {entries}\n      </GridBox>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport { Colors, Elevation, NonIdealState } from '@blueprintjs/core';\nimport styled from 'styled-components';\n\nimport { inject, observer } from 'mobx-react';\n\nimport PaddedCard from './PaddedCard';\nimport ResourceValue from './ResourceValue';\nimport TwoColumnTable from './TwoColumnTable';\nimport { streamStoreDefaultProps, StreamStoreProps } from '../store/stream';\n\nconst NonIdealBox = styled.div`\n  height: 340px;\n`;\n\n@inject(\"streamStore\")\n@observer\nexport default class Details extends Component<StreamStoreProps> {\n  static defaultProps = streamStoreDefaultProps;\n  render() {\n    const { characterEntity, currentCraft } = this.props.streamStore;\n\n    const noCraftMessage = (\n      <NonIdealBox>\n        <NonIdealState\n          icon=\"build\"\n          title=\"No crafting in progress\"\n          description=\"Start a craft to see current details on the crafting state.\"\n        />\n      </NonIdealBox>\n    );\n\n    if (!characterEntity) {\n      return (\n        <PaddedCard elevation={Elevation.THREE}>\n          <NonIdealBox>\n            <NonIdealState\n              icon=\"user\"\n              title=\"No character detected\"\n              description=\"Please rezone or log in to see the state of your current character.\"\n            />\n          </NonIdealBox>\n        </PaddedCard>\n      );\n    }\n\n    const { level, cp, maxCP, lastActionName, displayStatusList } = characterEntity;\n    const infos = {\n      Level: level,\n      CP: (<ResourceValue current={cp} max={maxCP} color={Colors.GOLD3} />),\n      LastAction: lastActionName,\n      Statuses: displayStatusList,\n      CurrentCraft: (currentCraft && currentCraft.info) || noCraftMessage,\n    };\n    return (\n      <PaddedCard elevation={Elevation.THREE}>\n        <TwoColumnTable infos={infos} />\n      </PaddedCard>\n    );\n  }\n}\n","import styled from 'styled-components';\n\nexport default styled.div`\n  display: inline-block;\n  margin-right: 5px;\n`;","import React, { Component } from 'react';\n\nimport { MenuItem, Classes } from '@blueprintjs/core';\n\nimport { observer } from 'mobx-react';\n\nimport InlineDiv from './InlineDiv';\nimport Craft from '../store/craft';\n\nconst smallClasses = `${Classes.TEXT_SMALL} ${Classes.TEXT_MUTED}`;\n\ninterface CraftListItemProps {\n  craft: Craft;\n  selected: boolean;\n\n  onSelect: (id: string) => void;\n}\n\n@observer\nexport default class CraftListItem extends Component<CraftListItemProps> {\n  onClick = () => {\n    this.props.onSelect(this.props.craft.id);\n  }\n\n  render() {\n    const { craft, selected } = this.props;\n\n    let child = (\n      <div>\n        <InlineDiv>{craft.recipe.name} </InlineDiv>\n        <InlineDiv className={smallClasses}>({craft.numSteps} steps) - {craft.timestamp}</InlineDiv>\n        {(!craft.failed && craft.completed) && <InlineDiv className={smallClasses}> COMPLETED</InlineDiv>}\n        {craft.failed && <InlineDiv className={smallClasses}> FAILED</InlineDiv>}\n      </div>\n    );\n\n    return (\n      <MenuItem text={child} active={selected} onClick={this.onClick} />\n    );\n  }\n}\n","import React, { Component } from 'react';\n\nimport { UL, Elevation, Colors, H5 } from '@blueprintjs/core';\nimport styled from 'styled-components';\n\nimport PaddedCard from './PaddedCard';\nimport CraftListItem from './CraftListItem';\n\nimport { inject, observer } from 'mobx-react';\nimport { streamStoreDefaultProps, StreamStoreProps } from '../store/stream';\n\nconst List = styled(UL)`\n  list-style: none;\n  padding: 0;\n  max-height: 30vh;\n  overflow-y: auto;\n\n  &::-webkit-scrollbar {\n    width: 5px;\n  }\n\n  &::-webkit-scrollbar-track {\n    background: ${Colors.GRAY1};\n  }\n\n  &::-webkit-scrollbar-thumb {\n    background: ${Colors.DARK_GRAY5};\n  }\n`;\n\nexport default class CraftListContainer extends Component {\n  render() {\n    return (\n      <PaddedCard elevation={Elevation.THREE}>\n        <H5>Craft Histories</H5>\n        <CraftList />\n      </PaddedCard>\n    );\n  }\n}\n\n@inject(\"streamStore\")\n@observer\nclass CraftList extends Component<StreamStoreProps> {\n  static defaultProps = streamStoreDefaultProps;\n\n  onSelect = (id: string) => {\n    this.props.streamStore.setSelectedCraftID(id);\n  }\n\n  render() {\n    const { craftHistory, selectedCraft } = this.props.streamStore;\n    return (\n      <List>\n        {Array.from(craftHistory).reverse().map(([_, c]) =>\n          <CraftListItem\n            key={c.id} craft={c}\n            selected={c === selectedCraft}\n            onSelect={this.onSelect}\n          />\n        )}\n      </List>\n    );\n  }\n}\n","import React, { Component } from 'react';\n\nimport { Elevation, NonIdealState, HTMLTable } from '@blueprintjs/core';\nimport styled from 'styled-components';\n\nimport PaddedCard from './PaddedCard';\nimport TwoColumnTable from './TwoColumnTable';\n\nimport { inject, observer } from 'mobx-react';\nimport { StreamStoreProps, streamStoreDefaultProps } from '../store/stream';\nimport { DisplayCraftInfo } from '../store/craft';\n\n\nconst NonIdealBox = styled.div`\n  height: 400px;\n`;\n\nconst Container = styled.div`\n  display: flex;\n  flex-direction: row;\n`;\n\nconst Content = styled.div`\n  flex: 1 0 auto;\n`;\n\n@inject(\"streamStore\")\n@observer\nexport default class CraftHistory extends Component<StreamStoreProps> {\n  static defaultProps = streamStoreDefaultProps;\n\n  render() {\n    const { selectedCraft } = this.props.streamStore;\n    if (!selectedCraft) {\n      return (\n        <PaddedCard elevation={Elevation.THREE}>\n          <NonIdealBox>\n            <NonIdealState\n              icon=\"list\"\n              title=\"No craft history selected\"\n              description=\"Select a craft history to view it.\"\n            />\n          </NonIdealBox>\n        </PaddedCard>\n      );\n    }\n\n    return (\n      <PaddedCard elevation={Elevation.THREE}>\n        <Container>\n          <Content>\n            <TwoColumnTable infos={selectedCraft.info} />\n          </Content>\n          <Content>\n            <HTMLTable condensed interactive striped>\n              <thead>\n                <tr>\n                  <th>Step Num</th>\n                  <th>Durability</th>\n                  <th>Progress</th>\n                  <th>Quality</th>\n                  <th>HQ Chance</th>\n                  <th>Condition</th>\n                  <th>Next Condition</th>\n                  <th>Action</th>\n                </tr>\n              </thead>\n              <tbody>\n                {selectedCraft.history.map((c: DisplayCraftInfo) =>\n                  <tr key={c.id}>\n                    <th>{c.StepNum - 1}</th>\n                    <th>{c.Durability}</th>\n                    <th>{c.Progress}</th>\n                    <th>{c.Quality}</th>\n                    <th>{c.HQChance}</th>\n                    <th>{c.PreviousCondition}</th>\n                    <th>{c.CurrentCondition}</th>\n                    <th>{c.LastCraftAction} </th>\n                  </tr>\n                )}\n              </tbody>\n            </HTMLTable>\n          </Content>\n        </Container>\n      </PaddedCard>\n    );\n  }\n}\n","import * as React from 'react';\nimport { Colors } from '@blueprintjs/core';\n\nimport styled from 'styled-components';\n\nimport './App.css';\n\nimport Details from './Details';\nimport CraftList from './CraftList';\nimport CraftHistory from './CraftHistory';\n\nconst AppRoot = styled.div`\n  background-color: ${Colors.DARK_GRAY3};\n  height: 100vh;\n  overflow-y: auto;\n\n  &::-webkit-scrollbar {\n    width: 5px;\n  }\n\n  &::-webkit-scrollbar-track {\n    background: ${Colors.GRAY1};\n  }\n\n  &::-webkit-scrollbar-thumb {\n    background: ${Colors.DARK_GRAY5};\n  }\n`;\n\nexport default class App extends React.Component {\n  render() {\n    return (\n      <AppRoot className=\"bp3-dark\">\n        <Details />\n        <CraftList />\n        <CraftHistory />\n      </AppRoot>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport ReactDOM from 'react-dom';\n\nimport { inject, observer, Provider } from 'mobx-react';\n\nimport streamStore, { PluginParams, StreamStoreProps, streamStoreDefaultProps } from './store/stream';\n\nimport App from './components/App';\n\ndeclare global {\n  interface Window {\n    waitForInit?: boolean;\n    initPlugin?: (params: PluginParams) => void;\n  }\n}\n\nconst getPluginParams = async (): Promise<PluginParams> => {\n  if (!window.waitForInit) {\n    return {\n      apiURL: 'http://localhost:8080/query',\n    };\n  } else {\n    return new Promise((resolve) => {\n      window.initPlugin = (params) => {\n        resolve(params);\n      };\n    });\n  }\n};\n\n@inject('streamStore')\n@observer\nclass Main extends Component<StreamStoreProps> {\n  static defaultProps = streamStoreDefaultProps;\n\n  componentDidMount() {\n    getPluginParams().then((params) => {\n      this.props.streamStore.initialize(params);\n    });\n  }\n\n  render() {\n    return <App />;\n  }\n}\n\n\nconst MainWithState = () => (\n  <Provider {...{ streamStore }}>\n    <Main />\n  </Provider>\n);\n\nReactDOM.render(<MainWithState />, document.getElementById('root'));\n"],"sourceRoot":""}